(function(){var t=function(t,n){return function(){return t.apply(n,arguments)}};!function(){var n,e,a,r,i,s;return r=function(){var n,e,a,r,i,s,o,d,l,p,c;return p=function(t,n){return $(t).tooltipster({theme:"tooltipster-light",animation:"grow",position:"bottom",content:n,contentAsHTML:!0}),$(t)},c=function(t){var n,e,a,r;e=t.ranking_projects||{},a=[];for(n in e)r=e[n],0!==r&&a.push(n);return a},d=function(t,n,e){var a,r,i,s,o,d,l,p,c,h;if(t=$.extend(!0,[],t),n)for(i=0,d=t.length;i<d;i++)r=t[i],r.times=(null!=(c=r.projects)?c[n]:void 0)||0;for(s=0,l=t.length;s<l;s++)a=t[s],a.total=Math.round(a.times*a.weight*10)/10;for(t=function(){var n,e,r;for(r=[],n=0,e=t.length;n<e;n++)a=t[n],a.times>0&&r.push(a);return r}(),t.sort(function(t,n){return n.total-t.total}),h=$("<table>"),e&&h.append('<tr class="project-header"><td colspan="2">'+(n+" ("+e+")</td></tr>")),o=0,p=t.length;o<p;o++)a=t[o],h.append("<tr><td>"+a.times+" "+a.label+'</td><td class="'+(a.total>0&&"plus"||"minus")+'">'+(a.total>0&&"+"||"")+a.total+"</td></tr>");return h},o=function(t){var n,e,a,r,i,s,o,l,h,u,g,m;if(g=$("<span>").addClass("score").text(t.ranking),h=c(t),h.length>0&&t.achievements){u=t.achievements;for(s in u)a=u[s],a.label=s;for(r=function(){var a,r;a=t.achievements,r=[];for(n in a)e=a[n],r.push(e);return r}(),m=$("<div>").addClass("score-tooltip"),i=0,o=h.length;i<o;i++)l=h[i],m.append(d(r,l,h.length>1&&t.ranking_projects[l]));p(g,m)}return g},n=function(t,n){var e,a,r,i,s,o,d,l,c,h;if(null==n&&(n=!1),e=$("<a>").addClass("badge").attr("href","#/x/analyzerPlugin/badges/"),e.append(t.awesomeFont),t.times>1&&e.append($("<sub>").text(t.times)),e.attr("title",t.name),h=$("<span>").addClass("badge-tooltip"),h.append($('<span class="badge-name">').text(t.name)),h.append($('<span class="badge-description">').text(t.description)),l=function(){var n,e;n=t.projects,e=[];for(o in n)c=n[o],c>0&&e.push({name:o,times:c});return e}(),n){for(l.sort(function(t,n){return n.times-t.times}),a=$('<ul class="badge-projects">'),r=0,i=l.length;r<i;r++)d=l[r],s=$("<li>"+d.name+"</li>"),d.times>1&&s.append("<span> ("+d.times+" times)</span>"),a.append(s);h.append(a)}return p(e,h)},e=function(t){var e,a,r,i,s,o;if(Object.keys(t.badges).length>0){o=c(t),r=$("<span>").addClass("badges"),i=t.badges,s=[];for(a in i)e=i[a],s.push(r.append(n(e,o.length>1)));return s}},i=function(t){var n;return t.stats?(t.avatar&&(n=$("<img>").addClass("avatar").attr("src",t.avatar).attr("onerror","$(this).css('display', 'none')")),$("<span>").addClass("developer-stats").append(n).append(t.name).append(o(t.stats)).append(e(t.stats))):""},s="https://review-analyzer.fslab.agh.edu.pl",new(r=function(){function n(n){this.developer=n,this.ready=t(this.ready,this)}return n.CACHE={},n.prototype.ready=function(t){return n.CACHE[this.developer.id]?t(n.CACHE[this.developer.id]):$.getJSON(s+"/review/api/badges/user/"+this.developer.email).done(function(e){return function(a){return t(n.CACHE[e.developer.id]=a)}}(this)).fail(function(){return t(null)})},n}()),setInterval(function(){return r.CACHE={}},3e5),l=new(function(){function n(){this.appendStatsTo=t(this.appendStatsTo,this),this.addDeveloperToDraw=t(this.addDeveloperToDraw,this),this.drawRankingStats=t(this.drawRankingStats,this),this.drawListStats=t(this.drawListStats,this),this.drawChangeDetailsStats=t(this.drawChangeDetailsStats,this),this.drawStats=t(this.drawStats,this),this.header=$("<div>").attr("id","analyzer-header"),$("#gerrit_header").after(this.header),this.requestNumber=0}return n.prototype.drawStats=function(t){var n;return null==t&&(t=5),this.header.children().remove(),this.developersToDraw={},(n=function(t){return function(e){return t.requestNumber++,$("#change_infoTable").length?t.drawChangeDetailsStats():$(".changeTable .cOWNER .accountLinkPanel").length?t.drawListStats():$(".ranking-badges").length?t.drawRankingStats():e>0?setTimeout(function(){return n(e-1)},500):void 0}}(this))(t)},n.prototype.drawChangeDetailsStats=function(){var t,n;return n=$(".com-google-gerrit-client-change-ChangeScreen_BinderImpl_GenCss_style-ownerPanel"),this.addDeveloperToDraw({name:n.find("a").text(),email:n.find("a").attr("title"),avatar:n.find("img").attr("src")}),$("#change_infoTable .com-google-gerrit-client-change-ChangeScreen_BinderImpl_GenCss_style-label_user").each(function(t){return function(n,e){return e=$(e).clone(),e.find("button").remove(),t.addDeveloperToDraw({name:e.text(),email:e.attr("title").split(" ")[0],avatar:e.find("img").attr("src")})}}(this)),t=$("<span>"),$(".com-google-gerrit-client-change-ChangeScreen_BinderImpl_GenCss_style-changeExtension").append("<hr>").append(t),this.appendStatsTo(t)},n.prototype.drawListStats=function(){return $(".changeTable .cOWNER .accountLinkPanel").each(function(t){return function(n,e){var a;return a=$(e).clone(),t.addDeveloperToDraw({name:a.find("a").text(),email:a.find("a").attr("title").match(/<(.+)>/)[1],avatar:a.find("img").attr("src")})}}(this)),this.appendStatsTo(this.header)},n.prototype.drawRankingStats=function(){return $(".ranking-badges").each(function(t){return function(t,n){var a;return a=$(n).attr("rel"),new r({id:a,email:a}).ready(function(t){return $(n).html(""),$(n).append(o(t)).append(e(t))})}}(this))},n.prototype.addDeveloperToDraw=function(t){return t.id=t.email,this.developersToDraw[t.id]=t},n.prototype.appendStatsTo=function(t){var n,e,a,s,o,d,l;e=this.requestNumber,s=Object.keys(this.developersToDraw).length,o=function(n){return function(){var e,a,r,s,o,d;for(r=function(){var t,n;t=this.developersToDraw,n=[];for(e in t)a=t[e],n.push(a);return n}.call(n),r.sort(function(t,n){var e,a;return(null!=(e=n.stats)?e.ranking:void 0)-(null!=(a=t.stats)?a.ranking:void 0)}),t.children().remove(),d=[],s=0,o=r.length;s<o;s++)a=r[s],d.push(t.append(i(a)));return d}}(this),d=this.developersToDraw,l=[];for(n in d)a=d[n],l.push(function(t){return function(n){return new r(n).ready(function(a){if(n.stats=a,--s<=0&&e===t.requestNumber)return o()})}}(this)(a));return l},n}()),a=new(function(){function n(){this.notifyAboutNewAchievements=t(this.notifyAboutNewAchievements,this),this.prepareStatsToCompare=t(this.prepareStatsToCompare,this),this.draw=t(this.draw,this)}return n.prototype.draw=function(){var t,n;return this.email=null!=(n=Gerrit.getCurrentUser())?n.email:void 0,this.email?(t={id:this.email,email:this.email},new r(t).ready(function(t){return function(n){if(t.currentStats=n,t.getContainer().children().remove(),t.getContainer().append(o(n)),t.getContainer().append(e(n)),!t.notified)return t.notifyAboutNewAchievements(),t.notified=!0}}(this))):this.getContainer().children().remove()},n.prototype.getContainer=function(){return 0===$("#currentUserBadges").length&&$(".menuBarUserName").after('<span id="currentUserBadges" class="developer-stats">'),$("#currentUserBadges")},n.prototype.prepareStatsToCompare=function(t){var n,e,a,r,i,s,o;null==t&&(t=this.currentStats),o={email:this.email,score:t.ranking,badges:{},achievements:{}},i=t.badges;for(a in i)r=i[a],o.badges[a]=r.times;s=t.achievements;for(n in s)e=s[n],e.weight>0&&(o.achievements[n]=e.times);return o},n.prototype.notifyAboutNewAchievements=function(){var t,n,e,a,r,i,s,o,d,l,p,c,h,u,g;if(this.currentStats){if(u=this.prepareStatsToCompare(),d=Cookies.getJSON("latestStats"),d&&d.email===this.email){l=$("<span>"),h=u.score-d.score,h>0&&(h=Math.round(10*h)/10,l.append($("<span>").addClass("score-gain").text("+"+h))),e=$("<ul>").addClass("achievements"),p=u.achievements;for(n in p)g=p[n],t=g-(d.achievements[n]||0),t>0&&e.append($("<li>").addClass("achievement").text("+"+t+" "+n));e.children().length&&l.append(e),i=$("<ul>").addClass("badges"),c=u.badges;for(r in c)g=c[r],a=g-(d.badges[r]||0),a>0&&(s=this.currentStats.badges[r].awesomeFont,o=this.currentStats.badges[r].name,i.append($("<li>").addClass("badge").html(s+" "+o)));i.children().length&&l.append(i),l.children().length&&$.tinyNotice(l.html(),"success",8e3)}return Cookies.set("latestStats",u,{expires:2,path:"/"})}},n}()),a.draw(),setInterval(a.draw,6e4),Gerrit.on("history",a.notifyAboutNewAchievements),Gerrit.on("history",l.drawStats),l.drawStats(15)},e=function(t){var n;return n=document.createElement("script"),n.type="text/javascript",n.src=t,document.head.append(n)},a=function(t){var n;return n=document.createElement("link"),n.rel="stylesheet",n.href=t,document.head.append(n)},i=function(){return $("<a>").tooltipster&&$.tinyNotice&&window.Cookies?r():setTimeout(i,100)},s=function(){return window.jQuery?(e("https://cdnjs.cloudflare.com/ajax/libs/tooltipster/3.3.0/js/jquery.tooltipster.min.js"),e("https://gitcdn.xyz/repo/ebrahimiaval/tinyNotice/master/dist/tinyNotice.js"),e("https://cdnjs.cloudflare.com/ajax/libs/js-cookie/2.1.3/js.cookie.min.js"),i()):setTimeout(s,100)},e("https://code.jquery.com/jquery-2.2.4.min.js"),a("https://gitcdn.xyz/repo/ebrahimiaval/tinyNotice/master/dist/tinyNotice-theme.css"),a("https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"),a("https://cdnjs.cloudflare.com/ajax/libs/tooltipster/3.3.0/css/themes/tooltipster-shadow.min.css"),n=document.createElement("style"),n.setAttribute("type","text/css"),n.innerText=".analyzer-panel {\n    border-spacing: 0px 5px;\n}\n\n.analyzer-runButton {\n    margin-top: 22px !important;\n    margin-left: 120px !important;\n}\n\n.analyzer-selectProject {\n    width: 350px !important;\n}\n\n.analyzer-dataRow {\n    border-collapse: separate;\n    border-spacing: 10px 5px;\n}\n\n.ranking-table > tbody > tr:first-child {\n    display: none;\n}\n\n.ranking-table img {\n    max-height: 20px\n}\n\n.ranking-table > tbody > tr:nth-child(2) {\n    background: gold;\n    font-size: 2em;\n}\n\n.ranking-table > tbody > tr:nth-child(2) img {\n    max-height: 40px;\n}\n\n.ranking-table > tbody > tr:nth-child(3) {\n    background: silver;\n    font-size: 1.7em;\n}\n\n.ranking-table > tbody > tr:nth-child(4) {\n    background: burlywood;\n    font-size: 1.3em;\n}\n\n.ranking-table td {\n    font-size: inherit;\n}\n\n.analyzer-popup {\n    width: 500px;\n    height: 500px;\n    left: 550px !important;\n    top: 200px !important;\n}\n\n.analyzer-popupPanel {\n    width: 480px;\n    height: 20px;\n}\n\n.analyzer-commentsList {\n    margin-left: 15px;\n}\n\n.analyzer-nodeGraph {\n    margin-left: 15px;\n}\n\n.developer-stats .score {\n    background: darkgreen;\n    font-weight: bold;\n    color: white;\n    border-radius: 5px;\n    padding: 1px 4px;\n    display: inline-block;\n    margin: 0 3px;\n    line-height: 1.2em;\n    font-size: 0.9em;\n    cursor: default;\n}\n\n.developer-stats .badge {\n    display: inline-block;\n    margin: 0 2px;\n    text-decoration: none;\n    outline: none;\n    color: inherit;\n}\n\n.developer-stats .badge sub {\n    font-weight: bold;\n}\n\n.developer-stats .avatar {\n    max-height: 15px;\n    margin-right: 3px;\n}\n\n#analyzer-header {\n    padding: 5px;\n    text-align: center;\n    font-size: 1.3em;\n}\n\n#analyzer-header .developer-stats {\n    display: inline-block;\n    margin: 5px 10px;\n}\n\n.com-google-gerrit-client-change-ChangeScreen_BinderImpl_GenCss_style-changeExtension .developer-stats {\n    display: block;\n    margin: 5px 0;\n}\n\n.score-tooltip tr.project-header {\n    font-weight: bold;\n    text-align: center;\n}\n\n.score-tooltip table {\n    margin-top: 5px;\n    padding-top: 5px;\n    width: 100%;\n}\n\n.score-tooltip table:first-child {\n    margin: 0;\n    padding: 0;\n}\n\n.score-tooltip .minus {\n    font-weight: bold;\n    color: darkred;\n}\n\n.score-tooltip .plus {\n    font-weight: bold;\n    color: darkgreen;\n}\n\n.menuBarUserNamePanel {\n    font-size: 15px;\n}\n\n@media screen and (max-width: 1370px) {\n    input.searchTextBox {\n        max-width: 300px;\n    }\n}\n\n.badge-tooltip .badge-name {\n    font-weight: bold;\n}\n\n.badge-tooltip > span {\n    display: block;\n}\n\n.badge-tooltip .badge-projects {\n    padding-left: 25px;\n    margin: 0;\n    margin-top: 5px;\n}\n\n.tinyNotice_status_success .score-gain {\n    display: block;\n    font-size: 2em;\n    font-weight: bold;\n    text-align: center;\n}\n\n.tinyNotice_status_success ul {\n    list-style-type:none;\n    padding: 0\n}\n\n.tinyNotice_status_success ul .fa {\n    color: white !important;\n    width:30px;\n    text-align: center\n}\n\n",document.head.append(n),s()}()}).call(this);