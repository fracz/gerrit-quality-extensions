(function(){var n=function(n,t){return function(){return n.apply(t,arguments)}};!function(){var t,e,a,i,r,s;return i=function(){var t,e,a,i,r,s,o,l,d,p,h,c;return s="https://review-analyzer.fslab.agh.edu.pl",p=function(n,t){var e;return"function"==typeof(e=$(n)).tooltipster&&e.tooltipster({theme:"tooltipster-light",animation:"grow",position:"bottom",content:t,contentAsHTML:!0}),$(n)},h=function(n){var t,e,a,i;e=n.ranking_projects||{},a=[];for(t in e)i=e[t],0!==i&&a.push(t);return a},l=function(n,t,e){var a,i,r,s,o,l,d,p,h,c;if(n=$.extend(!0,[],n),t)for(r=0,l=n.length;r<l;r++)i=n[r],i.times=(null!=(h=i.projects)?h[t]:void 0)||0;for(s=0,d=n.length;s<d;s++)a=n[s],a.total=Math.round(a.times*a.weight*10)/10;for(n=function(){var t,e,i;for(i=[],t=0,e=n.length;t<e;t++)a=n[t],a.times>0&&i.push(a);return i}(),n.sort(function(n,t){return t.total-n.total}),c=$("<table>"),e&&c.append('<tr class="project-header"><td colspan="2">'+(t+" ("+e+")</td></tr>")),o=0,p=n.length;o<p;o++)a=n[o],c.append("<tr><td>"+a.times+" "+a.label+'</td><td class="'+(a.total>0&&"plus"||"minus")+'">'+(a.total>0&&"+"||"")+a.total+"</td></tr>");return c},o=function(n){var t,e,a,i,r,s,o,d,c,u,f,m;if(f=$("<span>").addClass("score").text(n.ranking),c=h(n),c.length>0&&n.achievements){u=n.achievements;for(s in u)a=u[s],a.label=s;for(i=function(){var a,i;a=n.achievements,i=[];for(t in a)e=a[t],i.push(e);return i}(),m=$("<div>").addClass("score-tooltip"),r=0,o=c.length;r<o;r++)d=c[r],m.append(l(i,d,c.length>1&&n.ranking_projects[d]));p(f,m)}return f},t=function(n,t){var e,a,i,r,s,o,l,d,h,c;if(null==t&&(t=!1),e=$("<span>").addClass("badge"),e.append(n.awesomeFont),n.times>1&&e.append($("<sub>").text(n.times)),e.attr("title",n.name),c=$("<span>").addClass("badge-tooltip"),c.append($('<span class="badge-name">').text(n.name)),c.append($('<span class="badge-description">').text(n.description)),d=function(){var t,e;t=n.projects,e=[];for(o in t)h=t[o],h>0&&e.push({name:o,times:h});return e}(),t){for(d.sort(function(n,t){return t.times-n.times}),a=$('<ul class="badge-projects">'),i=0,r=d.length;i<r;i++)l=d[i],s=$("<li>"+l.name+"</li>"),l.times>1&&s.append("<span> ("+l.times+" times)</span>"),a.append(s);c.append(a)}return p(e,c)},e=function(n){var e,a,i,r,s,o;if(Object.keys(n.badges).length>0){o=h(n),i=$("<span>").addClass("badges"),r=n.badges,s=[];for(a in r)e=r[a],s.push(i.append(t(e,o.length>1)));return s}},r=function(n){var t;return n.stats?(n.avatar&&(t=$("<img>").addClass("avatar").attr("src",n.avatar).attr("onerror","$(this).css('display', 'none')")),$("<span>").addClass("developer-stats").append(t).append(n.name).append(o(n.stats)).append(e(n.stats))):""},new(i=function(){function t(t){this.developer=t,this.ready=n(this.ready,this)}return t.CACHE={},t.prototype.ready=function(n){return t.CACHE[this.developer.id]?n(t.CACHE[this.developer.id]):$.getJSON(s+"/review/api/badges/user/"+this.developer.email).done(function(e){return function(a){return n(t.CACHE[e.developer.id]=a)}}(this)).fail(function(){return n(null)})},t}()),setInterval(function(){return i.CACHE={}},3e5),d=new(function(){function t(){this.appendStatsTo=n(this.appendStatsTo,this),this.addDeveloperToDraw=n(this.addDeveloperToDraw,this),this.drawRankingStats=n(this.drawRankingStats,this),this.drawListStats=n(this.drawListStats,this),this.drawChangeDetailsStats=n(this.drawChangeDetailsStats,this),this.drawStats=n(this.drawStats,this),this.header=$("<div>").attr("id","analyzer-header"),$("#gerrit_header").after(this.header),this.requestNumber=0}return t.prototype.drawStats=function(n){var t;return null==n&&(n=5),this.header.children().remove(),this.developersToDraw={},(t=function(n){return function(e){return n.requestNumber++,$("#change_infoTable").length?n.drawChangeDetailsStats():$(".changeTable .cOWNER .accountLinkPanel").length?n.drawListStats():$(".ranking-badges").length?n.drawRankingStats():e>0?setTimeout(function(){return t(e-1)},500):void 0}}(this))(n)},t.prototype.drawChangeDetailsStats=function(){var n,t;return t=$(".com-google-gerrit-client-change-ChangeScreen_BinderImpl_GenCss_style-ownerPanel"),this.addDeveloperToDraw({name:t.find("a").text(),email:t.find("a").attr("title"),avatar:t.find("img").attr("src")}),$("#change_infoTable .com-google-gerrit-client-change-ChangeScreen_BinderImpl_GenCss_style-label_user").each(function(n){return function(t,e){return e=$(e).clone(),e.find("button").remove(),n.addDeveloperToDraw({name:e.text(),email:e.attr("title").split(" ")[0],avatar:e.find("img").attr("src")})}}(this)),n=$("<span>"),$(".com-google-gerrit-client-change-ChangeScreen_BinderImpl_GenCss_style-changeExtension").append("<hr>").append(n),this.appendStatsTo(n)},t.prototype.drawListStats=function(){return $(".changeTable .cOWNER .accountLinkPanel").each(function(n){return function(t,e){var a;return a=$(e).clone(),n.addDeveloperToDraw({name:a.find("a").text(),email:a.find("a").attr("title").match(/<(.+)>/)[1],avatar:a.find("img").attr("src")})}}(this)),this.appendStatsTo(this.header)},t.prototype.drawRankingStats=function(){return $(".ranking-badges").each(function(n){return function(n,t){var a;return a=$(t).attr("rel"),new i({id:a,email:a}).ready(function(n){return $(t).html(""),$(t).append(o(n)).append(e(n))})}}(this))},t.prototype.addDeveloperToDraw=function(n){return n.id=n.email,this.developersToDraw[n.id]=n},t.prototype.appendStatsTo=function(n){var t,e,a,s,o,l,d;e=this.requestNumber,s=Object.keys(this.developersToDraw).length,o=function(t){return function(){var e,a,i,s,o,l;for(i=function(){var n,t;n=this.developersToDraw,t=[];for(e in n)a=n[e],t.push(a);return t}.call(t),i.sort(function(n,t){var e,a;return(null!=(e=t.stats)?e.ranking:void 0)-(null!=(a=n.stats)?a.ranking:void 0)}),n.children().remove(),l=[],s=0,o=i.length;s<o;s++)a=i[s],l.push(n.append(r(a)));return l}}(this),l=this.developersToDraw,d=[];for(t in l)a=l[t],d.push(function(n){return function(t){return new i(t).ready(function(a){if(t.stats=a,--s<=0&&e===n.requestNumber)return o()})}}(this)(a));return d},t}()),a=new(function(){function t(){this.notifyAboutNewAchievements=n(this.notifyAboutNewAchievements,this),this.prepareStatsToCompare=n(this.prepareStatsToCompare,this),this.draw=n(this.draw,this)}return t.prototype.draw=function(){var n,t;return this.email=null!=(t=Gerrit.getCurrentUser())?t.email:void 0,this.email?(n={id:this.email,email:this.email},new i(n).ready(function(n){return function(t){if(n.currentStats=t,n.getContainer().children().remove(),n.getContainer().append(o(t)),n.getContainer().append(e(t)),!n.notified)return n.notifyAboutNewAchievements(),n.notified=!0}}(this))):this.getContainer().children().remove()},t.prototype.getContainer=function(){return 0===$("#currentUserBadges").length&&$(".menuBarUserName").after('<span id="currentUserBadges" class="developer-stats">'),$("#currentUserBadges")},t.prototype.prepareStatsToCompare=function(n){var t,e,a,i,r,s,o;null==n&&(n=this.currentStats),o={email:this.email,score:n.ranking,badges:{},achievements:{}},r=n.badges;for(a in r)i=r[a],o.badges[a]=i.times;s=n.achievements;for(t in s)e=s[t],e.weight>0&&(o.achievements[t]=e.times);return o},t.prototype.notifyAboutNewAchievements=function(){var n,t,e,a,i,r,s,o,l,d,p,h,c,u,f;if(this.currentStats){if(u=this.prepareStatsToCompare(),l=Cookies.getJSON("latestStats"),l&&l.email===this.email){d=$("<span>"),c=u.score-l.score,c>0&&(c=Math.round(10*c)/10,d.append($("<span>").addClass("score-gain").text("+"+c))),e=$("<ul>").addClass("achievements"),p=u.achievements;for(t in p)f=p[t],n=f-(l.achievements[t]||0),n>0&&e.append($("<li>").addClass("achievement").text("+"+n+" "+t));e.children().length&&d.append(e),r=$("<ul>").addClass("badges"),h=u.badges;for(i in h)f=h[i],a=f-(l.badges[i]||0),a>0&&(s=this.currentStats.badges[i].awesomeFont,o=this.currentStats.badges[i].name,r.append($("<li>").addClass("badge").html(s+" "+o)));r.children().length&&d.append(r),d.children().length&&$.tinyNotice(d.html(),"success",8e3)}return Cookies.set("latestStats",u,{expires:2,path:"/"})}},t}()),a.draw(),setInterval(a.draw,6e4),Gerrit.on("history",a.notifyAboutNewAchievements),$(".topmenuMenuLeft tr:first-child td.gwt-TabBarRest-wrapper").before('<td align="left" class="gwt-TabBarItem-wrapper" style="vertical-align: bottom;">\n  <div tabindex="0" class="gwt-TabBarItem" role="tab">\n    <div id="hall-of-fshame-link" class="gwt-Label" style="white-space: nowrap;">Hall Of FSHame</div>\n  </div>\n</td>'),c=document.createElement("div"),c.id="hall-of-fshame",c.innerHTML='<div style="position: fixed; top: 0; height: 100vh; width: 100%; z-index: 1000; background: rgba(255, 255, 255, .9); overflow: auto">\n    <button id="hall-of-fshame-close" style="float: right; font-size: 3em">X</button>\n    <h1 style="padding: 15px">IISG Hall Of FSHame</h1>\n        <div id="hall-of-fshame-loading" style="padding: 15px">Loading...</div>\n    <div id="hall-of-fshame-list" style="padding: 15px"></div>\n</div>\n',document.body.append(c),$("#hall-of-fshame").hide(),$("#hall-of-fshame-link").click(function(){return $("#hall-of-fshame, #hall-of-fshame-loading").show(),$("#hall-of-fshame-list").children().remove(),$.getJSON(s+"/review/api/badges/user").done(function(n){return function(n){var t,a,i,r,s;for($("#hall-of-fshame-loading").hide(),n=n.filter(function(n){return 0!==n.ranking}).sort(function(n,t){return t.ranking-n.ranking}),i=[],t=0,a=n.length;t<a;t++)s=n[t],r=$('<div class="hall-of-fshame-item"></div>'),r.append("<h4>"+s.name+"</h4>").append(o(s)).append(e(s)),i.push($("#hall-of-fshame-list").append(r));return i}}(this)).fail(function(){return callback(null)})}),$("#hall-of-fshame-close").click(function(){return $("#hall-of-fshame").hide()}),Gerrit.on("history",d.drawStats),d.drawStats(15)},e=function(n){var t;return t=document.createElement("script"),t.type="text/javascript",t.src=n,document.head.append(t)},a=function(n){var t;return t=document.createElement("link"),t.rel="stylesheet",t.href=n,document.head.append(t)},r=function(){return $("<a>").tooltipster&&$.tinyNotice&&window.Cookies&&window.Gerrit?i():setTimeout(r,100)},s=function(){return window.jQuery?(e("https://cdnjs.cloudflare.com/ajax/libs/tooltipster/3.3.0/js/jquery.tooltipster.min.js"),e("https://gitcdn.xyz/repo/ebrahimiaval/tinyNotice/master/dist/tinyNotice.js"),e("https://cdnjs.cloudflare.com/ajax/libs/js-cookie/2.1.3/js.cookie.min.js"),r()):setTimeout(s,100)},e("https://code.jquery.com/jquery-2.2.4.min.js"),a("https://gitcdn.xyz/repo/ebrahimiaval/tinyNotice/master/dist/tinyNotice-theme.css"),a("https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"),a("https://cdnjs.cloudflare.com/ajax/libs/tooltipster/3.3.0/css/tooltipster.css"),a("https://cdnjs.cloudflare.com/ajax/libs/tooltipster/3.3.0/css/themes/tooltipster-light.min.css"),t=document.createElement("style"),t.setAttribute("type","text/css"),t.innerText=".analyzer-panel {\n    border-spacing: 0px 5px;\n}\n\n.analyzer-runButton {\n    margin-top: 22px !important;\n    margin-left: 120px !important;\n}\n\n.analyzer-selectProject {\n    width: 350px !important;\n}\n\n.analyzer-dataRow {\n    border-collapse: separate;\n    border-spacing: 10px 5px;\n}\n\n.ranking-table > tbody > tr:first-child {\n    display: none;\n}\n\n.ranking-table img {\n    max-height: 20px\n}\n\n.ranking-table > tbody > tr:nth-child(2) {\n    background: gold;\n    font-size: 2em;\n}\n\n.ranking-table > tbody > tr:nth-child(2) img {\n    max-height: 40px;\n}\n\n.ranking-table > tbody > tr:nth-child(3) {\n    background: silver;\n    font-size: 1.7em;\n}\n\n.ranking-table > tbody > tr:nth-child(4) {\n    background: burlywood;\n    font-size: 1.3em;\n}\n\n.ranking-table td {\n    font-size: inherit;\n}\n\n.analyzer-popup {\n    width: 500px;\n    height: 500px;\n    left: 550px !important;\n    top: 200px !important;\n}\n\n.analyzer-popupPanel {\n    width: 480px;\n    height: 20px;\n}\n\n.analyzer-commentsList {\n    margin-left: 15px;\n}\n\n.analyzer-nodeGraph {\n    margin-left: 15px;\n}\n\n.developer-stats .score {\n    background: darkgreen;\n    font-weight: bold;\n    color: white;\n    border-radius: 5px;\n    padding: 1px 4px;\n    display: inline-block;\n    margin: 0 3px;\n    line-height: 1.2em;\n    font-size: 0.9em;\n    cursor: default;\n}\n\n.developer-stats .badge {\n    display: inline-block;\n    margin: 0 2px;\n    text-decoration: none;\n    outline: none;\n    color: inherit;\n}\n\n.developer-stats .badge sub {\n    font-weight: bold;\n}\n\n.developer-stats .avatar {\n    max-height: 15px;\n    margin-right: 3px;\n}\n\n#analyzer-header {\n    padding: 5px;\n    text-align: center;\n    font-size: 1.3em;\n}\n\n#analyzer-header .developer-stats {\n    display: inline-block;\n    margin: 5px 10px;\n}\n\n.com-google-gerrit-client-change-ChangeScreen_BinderImpl_GenCss_style-changeExtension .developer-stats {\n    display: block;\n    margin: 5px 0;\n}\n\n.score-tooltip tr.project-header {\n    font-weight: bold;\n    text-align: center;\n}\n\n.score-tooltip table {\n    margin-top: 5px;\n    padding-top: 5px;\n    width: 100%;\n}\n\n.score-tooltip table:first-child {\n    margin: 0;\n    padding: 0;\n}\n\n.score-tooltip .minus {\n    font-weight: bold;\n    color: darkred;\n}\n\n.score-tooltip .plus {\n    font-weight: bold;\n    color: darkgreen;\n}\n\n.menuBarUserNamePanel {\n    font-size: 15px;\n}\n\n@media screen and (max-width: 1370px) {\n    input.searchTextBox {\n        max-width: 300px;\n    }\n}\n\n.badge-tooltip .badge-name {\n    font-weight: bold;\n}\n\n.badge-tooltip > span {\n    display: block;\n}\n\n.badge-tooltip .badge-projects {\n    padding-left: 25px;\n    margin: 0;\n    margin-top: 5px;\n}\n\n.tinyNoticeWrap {\n    direction: ltr !important;\n}\n\n.tinyNoticeWrap.success .score-gain {\n    display: block;\n    font-size: 2em;\n    font-weight: bold;\n    text-align: center;\n}\n\n.tinyNoticeWrap.success ul {\n    list-style-type: none;\n    padding: 0\n}\n\n.tinyNoticeWrap.success ul .fa {\n    color: white !important;\n    width: 30px;\n    text-align: center\n}\n\n#hall-of-fshame-list .hall-of-fshame-item:first-child {\n    font-size: 4em;\n    background: gold;\n}\n#hall-of-fshame-list .hall-of-fshame-item:nth-child(2) {\n    font-size: 3em;\n    background: silver;\n}\n#hall-of-fshame-list .hall-of-fshame-item:nth-child(3) {\n    font-size: 2em;\n    background: bisque;\n}\n\n.hall-of-fshame-item .badge {\n    padding-right: 5px;\n}\n\n.hall-of-fshame-item {\n    padding: 10px;\n    max-width: 700px;\n    margin: 10px auto;\n}\n\n.hall-of-fshame-item h4 {\n    margin:0;\n}\n\n.hall-of-fshame-item .score {\n    float: right;\n}\n",document.head.append(t),s()}()}).call(this);